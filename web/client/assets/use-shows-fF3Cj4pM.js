import{r as F,j as w,a as k,P as Lt}from"./main-dCWhs5Ab.js";import{b as It}from"./Button-J-NJUGUV.js";import{c as at}from"./utils-BeoR-wkN.js";import{u as Tt}from"./useQuery-BpxkjsUK.js";import{o as Dt,s as W,n as _t,a as kt,c as Ot,b as Ct,q as Bt}from"./endpoint-DMaDmk8U.js";const R=new WeakMap,tt=new WeakMap,it={current:[]};let ot=!1,K=0;const G=new Set,z=new Map;function Vt(i){const a=Array.from(i).sort((t,e)=>t instanceof T&&t.options.deps.includes(e)?1:e instanceof T&&e.options.deps.includes(t)?-1:0);for(const t of a){if(it.current.includes(t))continue;it.current.push(t),t.recompute();const e=tt.get(t);if(e)for(const r of e){const s=R.get(r);s&&Vt(s)}}}function Pt(i){const a={prevVal:i.prevState,currentVal:i.state};for(const t of i.listeners)t(a)}function $t(i){const a={prevVal:i.prevState,currentVal:i.state};for(const t of i.listeners)t(a)}function St(i){if(K>0&&!z.has(i)&&z.set(i,i.prevState),G.add(i),!(K>0)&&!ot)try{for(ot=!0;G.size>0;){const a=Array.from(G);G.clear();for(const t of a){const e=z.get(t)??t.prevState;t.prevState=e,Pt(t)}for(const t of a){const e=R.get(t);e&&(it.current.push(t),Vt(e))}for(const t of a){const e=R.get(t);if(e)for(const r of e)$t(r)}}}finally{ot=!1,it.current=[],z.clear()}}function I(i){K++;try{i()}finally{if(K--,K===0){const a=G.values().next().value;a&&St(a)}}}function xt(i){return typeof i=="function"}class ut{constructor(a,t){this.listeners=new Set,this.subscribe=e=>{var r,s;this.listeners.add(e);const n=(s=(r=this.options)==null?void 0:r.onSubscribe)==null?void 0:s.call(r,e,this);return()=>{this.listeners.delete(e),n?.()}},this.prevState=a,this.state=a,this.options=t}setState(a){var t,e,r;this.prevState=this.state,(t=this.options)!=null&&t.updateFn?this.state=this.options.updateFn(this.prevState)(a):xt(a)?this.state=a(this.prevState):this.state=a,(r=(e=this.options)==null?void 0:e.onUpdate)==null||r.call(e),St(this)}}class T{constructor(a){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const t=this.options.deps.length,e=new Array(t),r=new Array(t);for(let s=0;s<t;s++){const n=this.options.deps[s];e[s]=n.prevState,r[s]=n.state}return this.lastSeenDepValues=r,{prevDepVals:e,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var t,e;this.prevState=this.state;const r=this.getDepVals();this.state=this.options.fn(r),(e=(t=this.options).onUpdate)==null||e.call(t)},this.checkIfRecalculationNeededDeeply=()=>{for(const s of this.options.deps)s instanceof T&&s.checkIfRecalculationNeededDeeply();let t=!1;const e=this.lastSeenDepValues,{currDepVals:r}=this.getDepVals();for(let s=0;s<r.length;s++)if(r[s]!==e[s]){t=!0;break}t&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const t of this._subscriptions)t()}),this.subscribe=t=>{var e,r;this.listeners.add(t);const s=(r=(e=this.options).onSubscribe)==null?void 0:r.call(e,t,this);return()=>{this.listeners.delete(t),s?.()}},this.options=a,this.state=a.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(a=this.options.deps){for(const t of a)if(t instanceof T)t.registerOnGraph(),this.registerOnGraph(t.options.deps);else if(t instanceof ut){let e=R.get(t);e||(e=new Set,R.set(t,e)),e.add(this);let r=tt.get(this);r||(r=new Set,tt.set(this,r)),r.add(t)}}unregisterFromGraph(a=this.options.deps){for(const t of a)if(t instanceof T)this.unregisterFromGraph(t.options.deps);else if(t instanceof ut){const e=R.get(t);e&&e.delete(this);const r=tt.get(this);r&&r.delete(t)}}}var Rt=class{constructor(i,a){this.fn=i,this.options=a,this.lastExecutionTime=0,this.isPending=!1,this.maybeExecute=(...t)=>{const e=Date.now()-this.lastExecutionTime;if(this.options.leading&&e>=this.options.wait)this.execute(...t);else if(this.lastArgs=t,!this.timeoutId&&this.options.trailing){const r=this.options.wait-e;this.isPending=!0,this.timeoutId=setTimeout(()=>{this.lastArgs!==void 0&&this.execute(...this.lastArgs)},r)}},this.execute=(...t)=>{this.fn(...t),this.options.onExecute?.(t,this),this.lastExecutionTime=Date.now(),this.clearTimeout(),this.lastArgs=void 0,this.isPending=!1},this.flush=()=>{this.isPending&&this.lastArgs&&this.execute(...this.lastArgs)},this.cancel=()=>{this.clearTimeout(),this.lastArgs=void 0,this.isPending=!1},this.clearTimeout=()=>{this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)},this.options.leading===void 0&&this.options.trailing===void 0&&(this.options.leading=!0,this.options.trailing=!0)}};function jt(i,a){return new Rt(i,a).maybeExecute}class Nt{#a=!0;#e;#t;#c;#s;#o;#i;#l;#h=0;#m=5;#n=!1;#u=!1;#r=null;#f=()=>{this.debugLog("Connected to event bus"),this.#o=!0,this.#n=!1,this.debugLog("Emitting queued events",this.#s),this.#s.forEach(a=>this.emitEventToBus(a)),this.#s=[],this.stopConnectLoop(),this.#t().removeEventListener("tanstack-connect-success",this.#f)};#d=()=>{if(this.#h<this.#m){this.#h++,this.dispatchCustomEvent("tanstack-connect",{});return}this.#t().removeEventListener("tanstack-connect",this.#d),this.#u=!0,this.debugLog("Max retries reached, giving up on connection"),this.stopConnectLoop()};#v=()=>{this.#n||(this.#n=!0,this.#t().addEventListener("tanstack-connect-success",this.#f),this.#d())};constructor({pluginId:a,debug:t=!1,enabled:e=!0,reconnectEveryMs:r=300}){this.#e=a,this.#a=e,this.#t=this.getGlobalTarget,this.#c=t,this.debugLog(" Initializing event subscription for plugin",this.#e),this.#s=[],this.#o=!1,this.#u=!1,this.#i=null,this.#l=r}startConnectLoop(){this.#i!==null||this.#o||(this.debugLog(`Starting connect loop (every ${this.#l}ms)`),this.#i=setInterval(this.#d,this.#l))}stopConnectLoop(){this.#n=!1,this.#i!==null&&(clearInterval(this.#i),this.#i=null,this.#s=[],this.debugLog("Stopped connect loop"))}debugLog(...a){this.#c&&console.log(`ðŸŒ´ [tanstack-devtools:${this.#e}-plugin]`,...a)}getGlobalTarget(){if(typeof globalThis<"u"&&globalThis.__TANSTACK_EVENT_TARGET__)return this.debugLog("Using global event target"),globalThis.__TANSTACK_EVENT_TARGET__;if(typeof window<"u"&&typeof window.addEventListener<"u")return this.debugLog("Using window as event target"),window;const a=typeof EventTarget<"u"?new EventTarget:void 0;return typeof a>"u"||typeof a.addEventListener>"u"?(this.debugLog("No event mechanism available, running in non-web environment"),{addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!1}):(this.debugLog("Using new EventTarget as fallback"),a)}getPluginId(){return this.#e}dispatchCustomEventShim(a,t){try{const e=new Event(a,{detail:t});this.#t().dispatchEvent(e)}catch{this.debugLog("Failed to dispatch shim event")}}dispatchCustomEvent(a,t){try{this.#t().dispatchEvent(new CustomEvent(a,{detail:t}))}catch{this.dispatchCustomEventShim(a,t)}}emitEventToBus(a){this.debugLog("Emitting event to client bus",a),this.dispatchCustomEvent("tanstack-dispatch-event",a)}createEventPayload(a,t){return{type:`${this.#e}:${a}`,payload:t,pluginId:this.#e}}emit(a,t){if(!this.#a){this.debugLog("Event bus client is disabled, not emitting event",a,t);return}if(this.#r&&(this.debugLog("Emitting event to internal event target",a,t),this.#r.dispatchEvent(new CustomEvent(`${this.#e}:${a}`,{detail:this.createEventPayload(a,t)}))),this.#u){this.debugLog("Previously failed to connect, not emitting to bus");return}if(!this.#o){this.debugLog("Bus not available, will be pushed as soon as connected"),this.#s.push(this.createEventPayload(a,t)),typeof CustomEvent<"u"&&!this.#n&&(this.#v(),this.startConnectLoop());return}return this.emitEventToBus(this.createEventPayload(a,t))}on(a,t,e){const r=e?.withEventTarget??!1,s=`${this.#e}:${a}`;if(r&&(this.#r||(this.#r=new EventTarget),this.#r.addEventListener(s,o=>{t(o.detail)})),!this.#a)return this.debugLog("Event bus client is disabled, not registering event",s),()=>{};const n=o=>{this.debugLog("Received event from bus",o.detail),t(o.detail)};return this.#t().addEventListener(s,n),this.debugLog("Registered event to bus",s),()=>{r&&this.#r?.removeEventListener(s,n),this.#t().removeEventListener(s,n)}}onAll(a){if(!this.#a)return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const t=e=>{const r=e.detail;a(r)};return this.#t().addEventListener("tanstack-devtools-global",t),()=>this.#t().removeEventListener("tanstack-devtools-global",t)}onAllPluginEvents(a){if(!this.#a)return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const t=e=>{const r=e.detail;this.#e&&r.pluginId!==this.#e||a(r)};return this.#t().addEventListener("tanstack-devtools-global",t),()=>this.#t().removeEventListener("tanstack-devtools-global",t)}}class Ut extends Nt{constructor(){super({pluginId:"form-devtools",reconnectEveryMs:1e3})}}const A=new Ut;function nt(i,a){return typeof i=="function"?i(a):i}function H(i,a){return mt(a).reduce((e,r)=>{if(e===null)return null;if(typeof e<"u")return e[r]},i)}function Q(i,a,t){const e=mt(a);function r(s){if(!e.length)return nt(t,s);const n=e.shift();if(typeof n=="string"||typeof n=="number"&&!Array.isArray(s))return typeof s=="object"?(s===null&&(s={}),{...s,[n]:r(s[n])}):{[n]:r()};if(Array.isArray(s)&&typeof n=="number"){const o=s.slice(0,n);return[...o.length?o:new Array(n),r(s[n]),...s.slice(n+1)]}return[...new Array(n),r()]}return r(i)}function Wt(i,a){const t=mt(a);function e(r){if(!r)return;if(t.length===1){const n=t[0];if(Array.isArray(r)&&typeof n=="number")return r.filter((h,l)=>l!==n);const{[n]:o,...u}=r;return u}const s=t.shift();if((typeof s=="string"||typeof s=="number"&&!Array.isArray(r))&&typeof r=="object")return{...r,[s]:e(r[s])};if(typeof s=="number"&&Array.isArray(r)){if(s>=r.length)return r;const n=r.slice(0,s);return[...n.length?n:new Array(s),e(r[s]),...r.slice(s+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return e(i)}const qt=/^(\d+)$/gm,Gt=/\.(\d+)(?=\.)/gm,Kt=/^(\d+)\./gm,zt=/\.(\d+$)/gm,Ht=/\.{2,}/gm,dt="__int__",X=`${dt}$1`;function mt(i){if(Array.isArray(i))return[...i];if(typeof i!="string")throw new Error("Path must be a string.");return i.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(qt,X).replace(Gt,`.${X}.`).replace(Kt,`${X}.`).replace(zt,`.${X}`).replace(Ht,".").split(".").map(a=>{if(a.startsWith(dt)){const t=a.substring(dt.length),e=parseInt(t,10);return String(e)===t?e:t}return a})}function Qt(i){return!(Array.isArray(i)&&i.length===0)}function ct(i,a){const t=e=>e.validators.filter(Boolean).map(r=>({cause:r.cause,validate:r.fn}));return a.validationLogic({form:a.form,validators:a.validators,event:{type:i,async:!1},runValidation:t})}function ht(i,a){const{asyncDebounceMs:t}=a,{onBlurAsyncDebounceMs:e,onChangeAsyncDebounceMs:r,onDynamicAsyncDebounceMs:s}=a.validators||{},n=t??0,o=u=>u.validators.filter(Boolean).map(h=>{const l=h?.cause||i;let c=n;switch(l){case"change":c=r??n;break;case"blur":c=e??n;break;case"dynamic":c=s??n;break;case"submit":c=0;break}return i==="submit"&&(c=0),{cause:l,validate:h.fn,debounceMs:c}});return a.validationLogic({form:a.form,validators:a.validators,event:{type:i,async:!0},runValidation:o})}const ft=i=>!!i&&typeof i=="object"&&"fields"in i;function O(i,a){if(Object.is(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;if(i instanceof Date&&a instanceof Date)return i.getTime()===a.getTime();if(i instanceof Map&&a instanceof Map){if(i.size!==a.size)return!1;for(const[r,s]of i)if(!a.has(r)||!Object.is(s,a.get(r)))return!1;return!0}if(i instanceof Set&&a instanceof Set){if(i.size!==a.size)return!1;for(const r of i)if(!a.has(r))return!1;return!0}const t=Object.keys(i),e=Object.keys(a);if(t.length!==e.length)return!1;for(const r of t)if(!e.includes(r)||!O(i[r],a[r]))return!1;return!0}const vt=({newFormValidatorError:i,isPreviousErrorFromFormValidator:a,previousErrorValue:t})=>i?{newErrorValue:i,newSource:"form"}:a?{newErrorValue:void 0,newSource:void 0}:t?{newErrorValue:t,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},gt=({formLevelError:i,fieldLevelError:a})=>a?{newErrorValue:a,newSource:"field"}:i?{newErrorValue:i,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function S(i,a){return i==null?a:{...i,...a}}let B=256;const et=[];let J;for(;B--;)et[B]=(B+256).toString(16).substring(1);function Ft(){let i=0,a,t="";if(!J||B+16>256){for(J=new Array(256),i=256;i--;)J[i]=256*Math.random()|0;i=0,B=0}for(;i<16;i++)a=J[B+i],i===6?t+=et[a&15|64]:i===8?t+=et[a&63|128]:t+=et[a],i&1&&i>1&&i<11&&(t+="-");return B++,t}const Xt=jt(i=>A.emit("form-state",{id:i.formId,state:i.store.state}),{wait:300}),$=i=>{if(!i.validators)return i.runValidation({validators:[],form:i.form});const a=i.event.async,t=a?void 0:{fn:i.validators.onMount,cause:"mount"},e={fn:a?i.validators.onChangeAsync:i.validators.onChange,cause:"change"},r={fn:a?i.validators.onBlurAsync:i.validators.onBlur,cause:"blur"},s={fn:a?i.validators.onSubmitAsync:i.validators.onSubmit,cause:"submit"},n=a?void 0:{fn:()=>{},cause:"server"};switch(i.event.type){case"mount":return i.runValidation({validators:[t],form:i.form});case"submit":return i.runValidation({validators:[e,r,s,n],form:i.form});case"server":return i.runValidation({validators:[],form:i.form});case"blur":return i.runValidation({validators:[r,n],form:i.form});case"change":return i.runValidation({validators:[e,n],form:i.form});default:throw new Error(`Unknown validation event type: ${i.event.type}`)}};function Jt(i,a){const t=new Map;for(const e of i){const r=e.path??[];let s=a,n="";for(let o=0;o<r.length;o++){const u=r[o];if(u===void 0)continue;const h=typeof u=="object"?u.key:u,l=Number(h);Array.isArray(s)&&!Number.isNaN(l)?n+=`[${l}]`:n+=(o>0?".":"")+String(h),typeof s=="object"&&s!==null?s=s[h]:s=void 0}t.set(n,(t.get(n)??[]).concat(e))}return Object.fromEntries(t)}const pt=(i,a)=>{const t=Jt(i,a);return{form:t,fields:t}},j={validate({value:i,validationSource:a},t){const e=t["~standard"].validate(i);if(e instanceof Promise)throw new Error("async function passed to sync validator");if(e.issues)return a==="field"?e.issues:pt(e.issues,i)},async validateAsync({value:i,validationSource:a},t){const e=await t["~standard"].validate(i);if(e.issues)return a==="field"?e.issues:pt(e.issues,i)}},Et=i=>!!i&&"~standard"in i,x={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function Y(i){function a(l,c,m){const d=n(l,c,"move",m),f=Math.min(c,m),g=Math.max(c,m);for(let v=f;v<=g;v++)d.push(s(l,v));const p=Object.keys(i.fieldInfo).reduce((v,b)=>(b.startsWith(s(l,c))&&v.set(b,i.getFieldMeta(b)),v),new Map);u(d,c<m?"up":"down"),Object.keys(i.fieldInfo).filter(v=>v.startsWith(s(l,m))).forEach(v=>{const b=v.replace(s(l,m),s(l,c)),y=p.get(b);y&&i.setFieldMeta(v,y)})}function t(l,c){const m=n(l,c,"remove");u(m,"up")}function e(l,c,m){n(l,c,"swap",m).forEach(f=>{if(!f.toString().startsWith(s(l,c)))return;const g=f.toString().replace(s(l,c),s(l,m)),[p,v]=[i.getFieldMeta(f),i.getFieldMeta(g)];p&&i.setFieldMeta(g,p),v&&i.setFieldMeta(f,v)})}function r(l,c){const m=n(l,c,"insert");u(m,"down"),m.forEach(d=>{d.toString().startsWith(s(l,c))&&i.setFieldMeta(d,h())})}function s(l,c){return`${l}[${c}]`}function n(l,c,m,d){const f=[s(l,c)];switch(m){case"swap":f.push(s(l,d));break;case"move":{const[g,p]=[Math.min(c,d),Math.max(c,d)];for(let v=g;v<=p;v++)f.push(s(l,v));break}default:{const g=i.getFieldValue(l),p=Array.isArray(g)?g.length:0;for(let v=c+1;v<p;v++)f.push(s(l,v));break}}return Object.keys(i.fieldInfo).filter(g=>f.some(p=>g.startsWith(p)))}function o(l,c){return l.replace(/\[(\d+)\]/,(m,d)=>{const f=parseInt(d,10);return`[${c==="up"?f+1:Math.max(0,f-1)}]`})}function u(l,c){(c==="up"?l:[...l].reverse()).forEach(d=>{const f=o(d.toString(),c),g=i.getFieldMeta(f);g?i.setFieldMeta(d,g):i.setFieldMeta(d,h())})}const h=()=>x;return{handleArrayMove:a,handleArrayRemove:t,handleArraySwap:e,handleArrayInsert:r}}function lt(i){return{values:i.values??{},errorMap:i.errorMap??{},fieldMetaBase:i.fieldMetaBase??{},isSubmitted:i.isSubmitted??!1,isSubmitting:i.isSubmitting??!1,isValidating:i.isValidating??!1,submissionAttempts:i.submissionAttempts??0,isSubmitSuccessful:i.isSubmitSuccessful??!1,validationMetaMap:i.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}}}class Mt{constructor(a){this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{const t=this.fieldMetaDerived.mount(),e=this.store.mount(),r=this.store.subscribe(()=>{Xt(this)}),s=A.on("request-form-state",l=>{l.payload.id===this._formId&&A.emit("form-api",{id:this._formId,state:this.store.state,options:this.options})}),n=A.on("request-form-reset",l=>{l.payload.id===this._formId&&this.reset()}),o=A.on("request-form-force-submit",l=>{l.payload.id===this._formId&&(this._devtoolsSubmissionOverride=!0,this.handleSubmit(),this._devtoolsSubmissionOverride=!1)}),u=()=>{o(),n(),s(),r(),t(),e(),A.emit("form-unmounted",{id:this._formId})};this.options.listeners?.onMount?.({formApi:this});const{onMount:h}=this.options.validators||{};return A.emit("form-api",{id:this._formId,state:this.store.state,options:this.options}),h&&this.validateSync("mount"),u},this.update=t=>{if(!t)return;const e=this.options;this.options=t;const r=!!t.transform?.deps?.some((o,u)=>o!==this.prevTransformArray[u]),s=t.defaultValues&&!O(t.defaultValues,e.defaultValues)&&!this.state.isTouched,n=!O(t.defaultState,e.defaultState)&&!this.state.isTouched;!s&&!n&&!r||(I(()=>{this.baseStore.setState(()=>lt(Object.assign({},this.state,n?t.defaultState:{},s?{values:t.defaultValues}:{},r?{_force_re_eval:!this.state._force_re_eval}:{})))}),A.emit("form-api",{id:this._formId,state:this.store.state,options:this.options}))},this.reset=(t,e)=>{const{fieldMeta:r}=this.state,s=this.resetFieldMeta(r);t&&!e?.keepDefaultValues&&(this.options={...this.options,defaultValues:t}),this.baseStore.setState(()=>lt({...this.options.defaultState,values:t??this.options.defaultValues??this.options.defaultState?.values,fieldMetaBase:s}))},this.validateAllFields=async t=>{const e=[];return I(()=>{Object.values(this.fieldInfo).forEach(s=>{if(!s.instance)return;const n=s.instance;e.push(Promise.resolve().then(()=>n.validate(t,{skipFormValidation:!0}))),s.instance.state.meta.isTouched||s.instance.setMeta(o=>({...o,isTouched:!0}))})}),(await Promise.all(e)).flat()},this.validateArrayFieldsStartingFrom=async(t,e,r)=>{const s=this.getFieldValue(t),n=Array.isArray(s)?Math.max(s.length-1,0):null,o=[`${t}[${e}]`];for(let c=e+1;c<=(n??0);c++)o.push(`${t}[${c}]`);const u=Object.keys(this.fieldInfo).filter(c=>o.some(m=>c.startsWith(m))),h=[];return I(()=>{u.forEach(c=>{h.push(Promise.resolve().then(()=>this.validateField(c,r)))})}),(await Promise.all(h)).flat()},this.validateField=(t,e)=>{const r=this.fieldInfo[t]?.instance;if(!r){const{hasErrored:s}=this.validateSync(e);return s&&!this.options.asyncAlways?this.getFieldMeta(t)?.errors??[]:this.validateAsync(e).then(()=>this.getFieldMeta(t)?.errors??[])}return r.state.meta.isTouched||r.setMeta(s=>({...s,isTouched:!0})),r.validate(e)},this.validateSync=t=>{const e=ct(t,{...this.options,form:this,validationLogic:this.options.validationLogic||$});let r=!1;const s={};return I(()=>{for(const u of e){if(!u.validate)continue;const h=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:l,fieldErrors:c}=st(h),m=q(u.cause),d=new Set([...Object.keys(this.state.fieldMeta),...Object.keys(c||{})]);for(const f of d){if(this.baseStore.state.fieldMetaBase[f]===void 0&&!c?.[f])continue;const g=this.getFieldMeta(f)??x,{errorMap:p,errorSourceMap:v}=g,b=c?.[f],{newErrorValue:y,newSource:V}=vt({newFormValidatorError:b,isPreviousErrorFromFormValidator:v?.[m]==="form",previousErrorValue:p?.[m]});V==="form"&&(s[f]={...s[f],[m]:b}),p?.[m]!==y&&this.setFieldMeta(f,(L=x)=>({...L,errorMap:{...L.errorMap,[m]:y},errorSourceMap:{...L.errorSourceMap,[m]:V}}))}this.state.errorMap?.[m]!==l&&this.baseStore.setState(f=>({...f,errorMap:{...f.errorMap,[m]:l}})),(l||c)&&(r=!0)}const n=q("submit");this.state.errorMap?.[n]&&t!=="submit"&&!r&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[n]:void 0}}));const o=q("server");this.state.errorMap?.[o]&&t!=="server"&&!r&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[o]:void 0}}))}),{hasErrored:r,fieldsErrorMap:s}},this.validateAsync=async t=>{const e=ht(t,{...this.options,form:this,validationLogic:this.options.validationLogic||$});this.state.isFormValidating||this.baseStore.setState(u=>({...u,isFormValidating:!0}));const r=[];let s;for(const u of e){if(!u.validate)continue;const h=q(u.cause);this.state.validationMetaMap[h]?.lastAbortController.abort();const c=new AbortController;this.state.validationMetaMap[h]={lastAbortController:c},r.push(new Promise(async m=>{let d;try{d=await new Promise((v,b)=>{setTimeout(async()=>{if(c.signal.aborted)return v(void 0);try{v(await this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:c.signal},type:"validateAsync"}))}catch(y){b(y)}},u.debounceMs)})}catch(v){d=v}const{formError:f,fieldErrors:g}=st(d);g&&(s=s?{...s,...g}:g);const p=q(u.cause);for(const v of Object.keys(this.state.fieldMeta)){if(this.baseStore.state.fieldMetaBase[v]===void 0)continue;const b=this.getFieldMeta(v);if(!b)continue;const{errorMap:y,errorSourceMap:V}=b,L=s?.[v],{newErrorValue:D,newSource:P}=vt({newFormValidatorError:L,isPreviousErrorFromFormValidator:V?.[p]==="form",previousErrorValue:y?.[p]});y?.[p]!==D&&this.setFieldMeta(v,_=>({..._,errorMap:{..._.errorMap,[p]:D},errorSourceMap:{..._.errorSourceMap,[p]:P}}))}this.baseStore.setState(v=>({...v,errorMap:{...v.errorMap,[p]:f}})),m(s?{fieldErrors:s,errorMapKey:p}:void 0)}))}let n=[];const o={};if(r.length){n=await Promise.all(r);for(const u of n)if(u?.fieldErrors){const{errorMapKey:h}=u;for(const[l,c]of Object.entries(u.fieldErrors)){const d={...o[l]||{},[h]:c};o[l]=d}}}return this.baseStore.setState(u=>({...u,isFormValidating:!1})),o},this.validate=t=>{const{hasErrored:e,fieldsErrorMap:r}=this.validateSync(t);return e&&!this.options.asyncAlways?r:this.validateAsync(t)},this._handleSubmit=async t=>{this.baseStore.setState(s=>({...s,isSubmitted:!1,submissionAttempts:s.submissionAttempts+1,isSubmitSuccessful:!1})),I(()=>{Object.values(this.fieldInfo).forEach(s=>{s.instance&&(s.instance.state.meta.isTouched||s.instance.setMeta(n=>({...n,isTouched:!0})))})});const e=t??this.options.onSubmitMeta;if(!this.state.canSubmit&&!this._devtoolsSubmissionOverride){this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e});return}this.baseStore.setState(s=>({...s,isSubmitting:!0}));const r=()=>{this.baseStore.setState(s=>({...s,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){r(),this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e}),A.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validateAllFields",errors:Object.values(this.state.fieldMeta).map(s=>s.errors).flat()});return}if(await this.validate("submit"),!this.state.isValid){r(),this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e}),A.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validate",errors:this.state.errors});return}I(()=>{Object.values(this.fieldInfo).forEach(s=>{s.instance?.options.listeners?.onSubmit?.({value:s.instance.state.value,fieldApi:s.instance})})}),this.options.listeners?.onSubmit?.({formApi:this,meta:e});try{await this.options.onSubmit?.({value:this.state.values,formApi:this,meta:e}),I(()=>{this.baseStore.setState(s=>({...s,isSubmitted:!0,isSubmitSuccessful:!0})),A.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!0}),r()})}catch(s){throw this.baseStore.setState(n=>({...n,isSubmitSuccessful:!1})),A.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"inflight",onError:s}),r(),s}},this.getFieldValue=t=>H(this.state.values,t),this.getFieldMeta=t=>this.state.fieldMeta[t],this.getFieldInfo=t=>this.fieldInfo[t]||={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}},this.setFieldMeta=(t,e)=>{this.baseStore.setState(r=>({...r,fieldMetaBase:{...r.fieldMetaBase,[t]:nt(e,r.fieldMetaBase[t])}}))},this.resetFieldMeta=t=>Object.keys(t).reduce((e,r)=>{const s=r;return e[s]=x,e},{}),this.setFieldValue=(t,e,r)=>{const s=r?.dontUpdateMeta??!1,n=r?.dontRunListeners??!1,o=r?.dontValidate??!1;I(()=>{s||this.setFieldMeta(t,u=>({...u,isTouched:!0,isDirty:!0,errorMap:{...u?.errorMap,onMount:void 0}})),this.baseStore.setState(u=>({...u,values:Q(u.values,t,e)}))}),n||this.getFieldInfo(t).instance?.triggerOnChangeListener(),o||this.validateField(t,"change")},this.deleteField=t=>{const r=[...Object.keys(this.fieldInfo).filter(s=>{const n=t.toString();return s!==n&&s.startsWith(n)}),t];this.baseStore.setState(s=>{const n={...s};return r.forEach(o=>{n.values=Wt(n.values,o),delete this.fieldInfo[o],delete n.fieldMetaBase[o]}),n})},this.pushFieldValue=(t,e,r)=>{this.setFieldValue(t,s=>[...Array.isArray(s)?s:[],e],r)},this.insertFieldValue=async(t,e,r,s)=>{this.setFieldValue(t,o=>[...o.slice(0,e),r,...o.slice(e)],S(s,{dontValidate:!0}));const n=s?.dontValidate??!1;n||await this.validateField(t,"change"),Y(this).handleArrayInsert(t,e),n||await this.validateArrayFieldsStartingFrom(t,e,"change")},this.replaceFieldValue=async(t,e,r,s)=>{this.setFieldValue(t,o=>o.map((u,h)=>h===e?r:u),S(s,{dontValidate:!0})),(s?.dontValidate??!1)||(await this.validateField(t,"change"),await this.validateArrayFieldsStartingFrom(t,e,"change"))},this.removeFieldValue=async(t,e,r)=>{const s=this.getFieldValue(t),n=Array.isArray(s)?Math.max(s.length-1,0):null;if(this.setFieldValue(t,u=>u.filter((h,l)=>l!==e),S(r,{dontValidate:!0})),Y(this).handleArrayRemove(t,e),n!==null){const u=`${t}[${n}]`;this.deleteField(u)}(r?.dontValidate??!1)||(await this.validateField(t,"change"),await this.validateArrayFieldsStartingFrom(t,e,"change"))},this.swapFieldValues=(t,e,r,s)=>{this.setFieldValue(t,o=>{const u=o[e],h=o[r];return Q(Q(o,`${e}`,h),`${r}`,u)},S(s,{dontValidate:!0})),Y(this).handleArraySwap(t,e,r),(s?.dontValidate??!1)||(this.validateField(t,"change"),this.validateField(`${t}[${e}]`,"change"),this.validateField(`${t}[${r}]`,"change"))},this.moveFieldValues=(t,e,r,s)=>{this.setFieldValue(t,o=>{const u=[...o];return u.splice(r,0,u.splice(e,1)[0]),u},S(s,{dontValidate:!0})),Y(this).handleArrayMove(t,e,r),(s?.dontValidate??!1)||(this.validateField(t,"change"),this.validateField(`${t}[${e}]`,"change"),this.validateField(`${t}[${r}]`,"change"))},this.clearFieldValues=(t,e)=>{const r=this.getFieldValue(t),s=Array.isArray(r)?Math.max(r.length-1,0):null;if(this.setFieldValue(t,[],S(e,{dontValidate:!0})),s!==null)for(let o=0;o<=s;o++){const u=`${t}[${o}]`;this.deleteField(u)}(e?.dontValidate??!1)||this.validateField(t,"change")},this.resetField=t=>{this.baseStore.setState(e=>({...e,fieldMetaBase:{...e.fieldMetaBase,[t]:x},values:this.options.defaultValues?Q(e.values,t,H(this.options.defaultValues,t)):e.values}))},this.setErrorMap=t=>{I(()=>{Object.entries(t).forEach(([e,r])=>{const s=e;if(ft(r)){const{formError:n,fieldErrors:o}=st(r);for(const u of Object.keys(this.fieldInfo))this.getFieldMeta(u)&&this.setFieldMeta(u,l=>({...l,errorMap:{...l.errorMap,[s]:o?.[u]},errorSourceMap:{...l.errorSourceMap,[s]:"form"}}));this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[s]:n}}))}else this.baseStore.setState(n=>({...n,errorMap:{...n.errorMap,[s]:r}}))})})},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((t,[e,r])=>(Object.keys(r).length&&r.errors.length&&(t[e]={errors:r.errors,errorMap:r.errorMap}),t),{})}),this.parseValuesWithSchema=t=>j.validate({value:this.state.values,validationSource:"form"},t),this.parseValuesWithSchemaAsync=t=>j.validateAsync({value:this.state.values,validationSource:"form"},t),this.timeoutIds={validations:{},listeners:{},formListeners:{}},this._formId=a?.formId??Ft(),this._devtoolsSubmissionOverride=!1,this.baseStore=new ut(lt({...a?.defaultState,values:a?.defaultValues??a?.defaultState?.values})),this.fieldMetaDerived=new T({deps:[this.baseStore],fn:({prevDepVals:t,currDepVals:e,prevVal:r})=>{const s=r,n=t?.[0],o=e[0];let u=0;const h={};for(const l of Object.keys(o.fieldMetaBase)){const c=o.fieldMetaBase[l],m=n?.fieldMetaBase[l],d=s?.[l],f=H(o.values,l);let g=d?.errors;if(!m||c.errorMap!==m.errorMap){g=Object.values(c.errorMap??{}).filter(V=>V!==void 0);const y=this.getFieldInfo(l)?.instance;(!y||!y.options.disableErrorFlat)&&(g=g.flat(1))}const p=!Qt(g),v=!c.isDirty,b=O(f,H(this.options.defaultValues,l))||O(f,this.getFieldInfo(l)?.instance?.options.defaultValue);if(d&&d.isPristine===v&&d.isValid===p&&d.isDefaultValue===b&&d.errors===g&&c===m){h[l]=d,u++;continue}h[l]={...c,errors:g??[],isPristine:v,isValid:p,isDefaultValue:b}}return Object.keys(o.fieldMetaBase).length&&s&&u===Object.keys(o.fieldMetaBase).length?s:h}}),this.store=new T({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:t,currDepVals:e,prevVal:r})=>{const s=r,n=t?.[0],o=e[0],u=e[1],h=Object.values(u).filter(Boolean),l=h.some(M=>M.isValidating),c=h.every(M=>M.isValid),m=h.some(M=>M.isTouched),d=h.some(M=>M.isBlurred),f=h.every(M=>M.isDefaultValue),g=m&&o.errorMap?.onMount,p=h.some(M=>M.isDirty),v=!p,b=!!(o.errorMap?.onMount||h.some(M=>M?.errorMap?.onMount)),y=!!l;let V=s?.errors??[];(!n||o.errorMap!==n.errorMap)&&(V=Object.values(o.errorMap).reduce((M,C)=>C===void 0?M:C&&ft(C)?(M.push(C.form),M):(M.push(C),M),[]));const L=V.length===0,D=c&&L,P=this.options.canSubmitWhenInvalid??!1,_=o.submissionAttempts===0&&!m&&!b||!y&&!o.isSubmitting&&D||P;let E=o.errorMap;if(g&&(V=V.filter(M=>M!==o.errorMap.onMount),E=Object.assign(E,{onMount:void 0})),s&&n&&s.errorMap===E&&s.fieldMeta===this.fieldMetaDerived.state&&s.errors===V&&s.isFieldsValidating===l&&s.isFieldsValid===c&&s.isFormValid===L&&s.isValid===D&&s.canSubmit===_&&s.isTouched===m&&s.isBlurred===d&&s.isPristine===v&&s.isDefaultValue===f&&s.isDirty===p&&O(n,o))return s;let N={...o,errorMap:E,fieldMeta:this.fieldMetaDerived.state,errors:V,isFieldsValidating:l,isFieldsValid:c,isFormValid:L,isValid:D,canSubmit:_,isTouched:m,isBlurred:d,isPristine:v,isDefaultValue:f,isDirty:p};const U=this.options.transform?.deps??[];if(U.length!==this.prevTransformArray.length||U.some((M,C)=>M!==this.prevTransformArray[C])){const M=Object.assign({},this,{state:N});this.options.transform?.fn(M),N=M.state,this.prevTransformArray=U}return N}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(a||{})}get state(){return this.store.state}get formId(){return this._formId}runValidator(a){return Et(a.validate)?j[a.type](a.value,a.validate):a.validate(a.value)}handleSubmit(a){return this._handleSubmit(a)}}function st(i){if(i){if(ft(i)){const a=st(i.form).formError,t=i.fields;return{formError:a,fieldErrors:t}}return{formError:i}}return{formError:void 0}}function q(i){switch(i){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";default:return"onChange"}}class bt{constructor(a){this.options={},this.mount=()=>{const t=this.store.mount();this.options.defaultValue!==void 0&&!this.getMeta().isTouched&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const e=this.getInfo();e.instance=this,this.update(this.options);const{onMount:r}=this.options.validators||{};if(r){const s=this.runValidator({validate:r,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});s&&this.setMeta(n=>({...n,errorMap:{...n?.errorMap,onMount:s},errorSourceMap:{...n?.errorSourceMap,onMount:"field"}}))}return this.options.listeners?.onMount?.({value:this.state.value,fieldApi:this}),t},this.update=t=>{if(this.options=t,this.name=t.name,!this.state.meta.isTouched&&this.options.defaultValue!==void 0){const e=this.form.getFieldValue(this.name);O(e,t.defaultValue)||this.form.setFieldValue(this.name,t.defaultValue,{dontUpdateMeta:!0,dontValidate:!0,dontRunListeners:!0})}this.form.getFieldMeta(this.name)||this.form.setFieldMeta(this.name,this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(t,e)=>{this.form.setFieldValue(this.name,t,S(e,{dontRunListeners:!0,dontValidate:!0})),e?.dontRunListeners||this.triggerOnChangeListener(),e?.dontValidate||this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=t=>this.form.setFieldMeta(this.name,t),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(t,e)=>{this.form.pushFieldValue(this.name,t,S(e,{dontRunListeners:!0})),e?.dontRunListeners||this.triggerOnChangeListener()},this.insertValue=(t,e,r)=>{this.form.insertFieldValue(this.name,t,e,S(r,{dontRunListeners:!0})),r?.dontRunListeners||this.triggerOnChangeListener()},this.replaceValue=(t,e,r)=>{this.form.replaceFieldValue(this.name,t,e,S(r,{dontRunListeners:!0})),r?.dontRunListeners||this.triggerOnChangeListener()},this.removeValue=(t,e)=>{this.form.removeFieldValue(this.name,t,S(e,{dontRunListeners:!0})),e?.dontRunListeners||this.triggerOnChangeListener()},this.swapValues=(t,e,r)=>{this.form.swapFieldValues(this.name,t,e,S(r,{dontRunListeners:!0})),r?.dontRunListeners||this.triggerOnChangeListener()},this.moveValue=(t,e,r)=>{this.form.moveFieldValues(this.name,t,e,S(r,{dontRunListeners:!0})),r?.dontRunListeners||this.triggerOnChangeListener()},this.clearValues=t=>{this.form.clearFieldValues(this.name,S(t,{dontRunListeners:!0})),t?.dontRunListeners||this.triggerOnChangeListener()},this.getLinkedFields=t=>{const e=Object.values(this.form.fieldInfo),r=[];for(const s of e){if(!s.instance)continue;const{onChangeListenTo:n,onBlurListenTo:o}=s.instance.options.validators||{};t==="change"&&n?.includes(this.name)&&r.push(s.instance),t==="blur"&&o?.includes(this.name)&&r.push(s.instance)}return r},this.validateSync=(t,e)=>{const r=ct(t,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||$}),n=this.getLinkedFields(t).reduce((h,l)=>{const c=ct(t,{...l.options,form:l.form,validationLogic:l.form.options.validationLogic||$});return c.forEach(m=>{m.field=l}),h.concat(c)},[]);let o=!1;I(()=>{const h=(l,c)=>{const m=Z(c.cause),d=c.validate?yt(l.runValidator({validate:c.validate,value:{value:l.store.state.value,validationSource:"field",fieldApi:l},type:"validate"})):void 0,f=e[m],{newErrorValue:g,newSource:p}=gt({formLevelError:f,fieldLevelError:d});l.state.meta.errorMap?.[m]!==g&&l.setMeta(v=>({...v,errorMap:{...v.errorMap,[m]:g},errorSourceMap:{...v.errorSourceMap,[m]:p}})),g&&(o=!0)};for(const l of r)h(this,l);for(const l of n)l.validate&&h(l.field,l)});const u=Z("submit");return this.state.meta.errorMap?.[u]&&t!=="submit"&&!o&&this.setMeta(h=>({...h,errorMap:{...h.errorMap,[u]:void 0},errorSourceMap:{...h.errorSourceMap,[u]:void 0}})),{hasErrored:o}},this.validateAsync=async(t,e)=>{const r=ht(t,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||$}),s=await e,n=this.getLinkedFields(t),o=n.reduce((d,f)=>{const g=ht(t,{...f.options,form:f.form,validationLogic:f.form.options.validationLogic||$});return g.forEach(p=>{p.field=f}),d.concat(g)},[]),u=[],h=[],l=r.some(d=>d.validate)||o.some(d=>d.validate);if(l){this.state.meta.isValidating||this.setMeta(d=>({...d,isValidating:!0}));for(const d of n)d.setMeta(f=>({...f,isValidating:!0}))}const c=(d,f,g)=>{const p=Z(f.cause);d.getInfo().validationMetaMap[p]?.lastAbortController.abort();const b=new AbortController;this.getInfo().validationMetaMap[p]={lastAbortController:b},g.push(new Promise(async y=>{let V;try{V=await new Promise((E,N)=>{this.timeoutIds.validations[f.cause]&&clearTimeout(this.timeoutIds.validations[f.cause]),this.timeoutIds.validations[f.cause]=setTimeout(async()=>{if(b.signal.aborted)return E(void 0);try{E(await this.runValidator({validate:f.validate,value:{value:d.store.state.value,fieldApi:d,signal:b.signal,validationSource:"field"},type:"validateAsync"}))}catch(U){N(U)}},f.debounceMs)})}catch(E){V=E}if(b.signal.aborted)return y(void 0);const L=yt(V),D=s[this.name]?.[p],{newErrorValue:P,newSource:_}=gt({formLevelError:D,fieldLevelError:L});d.setMeta(E=>({...E,errorMap:{...E?.errorMap,[p]:P},errorSourceMap:{...E.errorSourceMap,[p]:_}})),y(P)}))};for(const d of r)d.validate&&c(this,d,u);for(const d of o)d.validate&&c(d.field,d,h);let m=[];if((u.length||h.length)&&(m=await Promise.all(u),await Promise.all(h)),l){this.setMeta(d=>({...d,isValidating:!1}));for(const d of n)d.setMeta(f=>({...f,isValidating:!1}))}return m.filter(Boolean)},this.validate=(t,e)=>{if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:r}=e?.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(t),{hasErrored:s}=this.validateSync(t,r[this.name]??{});if(s&&!this.options.asyncAlways)return this.getInfo().validationMetaMap[Z(t)]?.lastAbortController.abort(),this.state.meta.errors;const n=e?.skipFormValidation?Promise.resolve({}):this.form.validateAsync(t);return this.validateAsync(t,n)},this.handleChange=t=>{this.setValue(t)},this.handleBlur=()=>{this.state.meta.isTouched||this.setMeta(e=>({...e,isTouched:!0})),this.state.meta.isBlurred||this.setMeta(e=>({...e,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.setErrorMap=t=>{this.setMeta(e=>({...e,errorMap:{...e.errorMap,...t}}))},this.parseValueWithSchema=t=>j.validate({value:this.state.value,validationSource:"field"},t),this.parseValueWithSchemaAsync=t=>j.validateAsync({value:this.state.value,validationSource:"field"},t),this.triggerOnChangeListener=()=>{const t=this.form.options.listeners?.onChangeDebounceMs;t&&t>0?(this.timeoutIds.formListeners.change&&clearTimeout(this.timeoutIds.formListeners.change),this.timeoutIds.formListeners.change=setTimeout(()=>{this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this})},t)):this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this});const e=this.options.listeners?.onChangeDebounceMs;e&&e>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})},e)):this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})},this.form=a.form,this.name=a.name,this.options=a,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new T({deps:[this.form.store],fn:({prevVal:t})=>{const e=t,r=this.form.getFieldMeta(this.name)??{...x,...a.defaultMeta};let s=this.form.getFieldValue(this.name);return!r.isTouched&&s===void 0&&this.options.defaultValue!==void 0&&!O(s,this.options.defaultValue)&&(s=this.options.defaultValue),e&&e.value===s&&e.meta===r?e:{value:s,meta:r}}})}get state(){return this.store.state}runValidator(a){return Et(a.validate)?j[a.type](a.value,a.validate):a.validate(a.value)}triggerOnBlurListener(){const a=this.form.options.listeners?.onBlurDebounceMs;a&&a>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this})},a)):this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this});const t=this.options.listeners?.onBlurDebounceMs;t&&t>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})},t)):this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})}}function yt(i){if(i)return i}function Z(i){switch(i){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";default:return"onChange"}}const rt=typeof window<"u"?F.useLayoutEffect:F.useEffect;function Yt(i){const[a,t]=F.useState(()=>({form:i.form,name:i.name})),[e,r]=F.useState(()=>new bt({...i}));(a.form!==i.form||a.name!==i.name)&&(r(new bt({...i})),t({form:i.form,name:i.name}));const s=k(e.store,i.mode==="array"?d=>Object.keys(d.value??[]).length:d=>d.value),n=k(e.store,d=>d.meta.isTouched),o=k(e.store,d=>d.meta.isBlurred),u=k(e.store,d=>d.meta.isDirty),h=k(e.store,d=>d.meta.errorMap),l=k(e.store,d=>d.meta.errorSourceMap),c=k(e.store,d=>d.meta.isValidating),m=F.useMemo(()=>{const f={...e,get state(){return{value:i.mode==="array"?e.state.value:s,get meta(){return{...e.state.meta,isTouched:n,isBlurred:o,isDirty:u,errorMap:h,errorSourceMap:l,isValidating:c}}}}};return f.Field=wt,f},[e,i.mode,s,n,o,u,h,l,c]);return rt(e.mount,[e]),rt(()=>{e.update(i)}),m}const wt=(({children:i,...a})=>{const t=Yt(a),e=F.useMemo(()=>nt(i,t),[i,t]);return w.jsx(w.Fragment,{children:e})});function Zt(){return F.useState(()=>Ft())[0]}const te=F.version.split(".")[0]==="17"?Zt:F.useId;function ee({form:i,selector:a,children:t}){const e=k(i.store,a);return w.jsx(w.Fragment,{children:nt(t,e)})}function pe(i){const a=te(),[t,e]=F.useState(i?.formId),[r,s]=F.useState(()=>new Mt({...i,formId:i?.formId??a}));if(t!==i?.formId){const o=i?.formId??a;s(new Mt({...i,formId:o})),e(o)}const n=F.useMemo(()=>{const o={...r,handleSubmit:((...u)=>r._handleSubmit(...u)),get formId(){return r._formId},get state(){return r.store.state}};return o.Field=function(h){return w.jsx(wt,{...h,form:r})},o.Subscribe=function(h){return w.jsx(ee,{form:r,selector:h.selector,children:h.children})},o},[r]);return rt(r.mount,[]),rt(()=>{r.update(i)}),n}var se="Label",At=F.forwardRef((i,a)=>w.jsx(Lt.label,{...i,ref:a,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(i.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));At.displayName=se;var ie=At;function re({className:i,...a}){return w.jsx(ie,{"data-slot":"label",className:at("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",i),...a})}const ae=It("group/field flex w-full gap-3 data-[invalid=true]:text-destructive",{variants:{orientation:{vertical:["flex-col [&>*]:w-full [&>.sr-only]:w-auto"],horizontal:["flex-row items-center","[&>[data-slot=field-label]]:flex-auto","has-[>[data-slot=field-content]]:items-start has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px"],responsive:["flex-col [&>*]:w-full [&>.sr-only]:w-auto @md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto","@md/field-group:[&>[data-slot=field-label]]:flex-auto","@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px"]}},defaultVariants:{orientation:"vertical"}});function Me({className:i,orientation:a="vertical",...t}){return w.jsx("div",{role:"group","data-slot":"field","data-orientation":a,className:at(ae({orientation:a}),i),...t})}function be({className:i,...a}){return w.jsx(re,{"data-slot":"field-label",className:at("group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50","has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border *:data-[slot=field]:p-4","has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10",i),...a})}function ye({className:i,children:a,errors:t,...e}){const r=F.useMemo(()=>{if(a)return a;if(!t?.length)return null;const s=[...new Map(t.map(n=>[n?.message,n])).values()];return s?.length==1?s[0]?.message:w.jsx("ul",{className:"ml-4 flex list-disc flex-col gap-1",children:s.map((n,o)=>n?.message&&w.jsx("li",{children:n.message},o))})},[a,t]);return r?w.jsx("div",{role:"alert","data-slot":"field-error",className:at("text-destructive text-sm font-normal",i),...e,children:r}):null}const ne=Dt({show_id:W().uuid(),dead_nation_id:W().uuid(),number_of_tickets:_t().int().nonnegative(),start_time:W().datetime(),title:W(),venue:W()}),oe=kt(ne).or(Ot());async function le(){const i=Ct(["api","shows"]),a=await fetch(i);if(!a.ok)throw new Error(`Failed to get shows: ${a.statusText}`);const t=await a.json();return oe.parse(t)}const ue={all:()=>["shows"],list:()=>["shows","list"],mutations:{create:()=>["shows","create"]}},de={list:()=>Bt({queryKey:ue.list(),queryFn:()=>le()})};function Ve(){return Tt(de.list())}export{Me as F,be as a,ye as b,Ve as c,de as q,ue as s,pe as u};
