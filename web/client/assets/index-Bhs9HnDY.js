import{u as m,r as f,j as e}from"./main-dCWhs5Ab.js";import{a as x}from"./Button-J-NJUGUV.js";import{T as r}from"./Table-DH2M_JZR.js";import{f as h}from"./utils-BeoR-wkN.js";import{u as j}from"./useMutation-DIq7UHwp.js";import{b as p}from"./endpoint-DMaDmk8U.js";import{t as a,q as k}from"./queries-DPZSBU53.js";import{u as y}from"./useQuery-BpxkjsUK.js";async function T(i){const n=p(["api","ticket-refund",i]),s=await fetch(n,{method:"PUT"});if(!s.ok)throw new Error(`Failed to refund ticket: ${s.statusText}`)}function g(i){const n=m();return j({mutationKey:a.mutations.refund(),mutationFn:s=>T(s),onSuccess:()=>{n.invalidateQueries({queryKey:a.all()}),i?.onSuccess?.()},onError:i?.onError})}function R(){return y(k.list())}function q(){const{data:i=[],isLoading:n,isError:s}=R(),[c,o]=f.useState(null),{mutate:l,isPending:u}=g({onSuccess:()=>{o(null)},onError:t=>{console.error("Failed to refund ticket:",t),o(null)}}),d=t=>{confirm(`Are you sure you want to refund ticket ${t}?`)&&(o(t),l(t))};return n?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-lg",children:"Loading tickets..."})}):s?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-lg text-red-600",children:"Failed to load tickets"})}):i.length===0?e.jsx("p",{className:"text-center py-8 text-lg",children:"No tickets yet. Book some tickets first!"}):e.jsxs(r,{children:[e.jsx(r.Header,{children:e.jsxs(r.Row,{children:[e.jsx(r.Head,{children:"Ticket ID"}),e.jsx(r.Head,{children:"Price"}),e.jsx(r.Head,{children:"Customer Email"}),e.jsx(r.Head,{children:"Actions"})]})}),e.jsx(r.Body,{children:i.map(t=>e.jsxs(r.Row,{children:[e.jsx(r.Cell,{children:t.ticket_id}),e.jsx(r.Cell,{children:h(t.price_amount,t.price_currency)}),e.jsx(r.Cell,{children:t.customer_email}),e.jsx(r.Cell,{children:e.jsx(x,{onClick:()=>d(t.ticket_id),disabled:u&&c===t.ticket_id,variant:"destructive",size:"sm",children:u&&c===t.ticket_id?"Refunding...":"Refund"})})]},t.ticket_id))})]})}export{q as component};
